import{u as b,a as N,t,j as e}from"./index-BPpD_G1B.js";import{s as k}from"./statService-ia_1TWhZ.js";import{C as S}from"./index-Cz44ne4F.js";import{z as f,S as A}from"./vendor-ui-B8JNe9Dz.js";import{r as o}from"./vendor-core-D3G3Pc5t.js";import L from"./RefreshIcon-Dt0ZO-Zu.js";import O from"./api-latency-chart-BRYQ93AJ.js";import"./vendor-utils-9ATX-dPw.js";import"./chart-Cy0_8YSU.js";import"./vendor-charts-C0vSEv4L.js";import"./useChart-CpCJAxAv.js";import"./api-sample-modal-CEnMhLbC.js";const R={totalCount:0,status5xx:0,slowCount:0,avgLatency:0,updatedAt:""},x=a=>a.toLocaleString();function B(){const{t:a}=b(),i=N(),[d,m]=o.useState(!1),[h,u]=o.useState(!1),[r,y]=o.useState(R),[g,w]=o.useState("count"),n=o.useCallback(async()=>{if(i)try{u(!0);const s=f(),c=s.startOf("day").unix(),C=s.unix(),l=await k.apiSummary(c,C);y({totalCount:l.count,status5xx:l.count5xx,slowCount:l.slowCount,avgLatency:Math.round(l.avgLatency),updatedAt:l.updatedAt?f.unix(l.updatedAt).format("HH:mm"):""})}catch{}finally{u(!1)}},[i]);o.useEffect(()=>{n()},[n]);const j=o.useMemo(()=>`linear-gradient(135deg, rgba(${t.colors.palette.primary.lightChannel}, 0.12), rgba(${t.colors.palette.success.lightChannel}, 0.14)) ${t.colors.background.paper}`,[]),p=(s="count",c)=>{c&&c.stopPropagation(),!d&&(w(s),m(!0))},v=o.useCallback(s=>{s.stopPropagation(),n()},[n]);return e.jsxs("div",{onClick:()=>p("count"),className:"h-full w-full",children:[e.jsx(A,{spinning:h,className:"h-full",children:e.jsx(S,{className:"!p-0 overflow-hidden w-full",style:{background:j,padding:0,boxShadow:t.shadows.card,cursor:"pointer",minHeight:133,height:"auto",flexShrink:0},children:e.jsx("div",{className:"flex h-full flex-col gap-4 p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",style:{color:t.colors.text.primary},children:a("sys.workbench.apiResponseToday")}),e.jsx("div",{className:"mt-3 flex flex-wrap items-end gap-4 justify-between",children:e.jsxs("div",{className:"flex flex-wrap gap-x-8 gap-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-1 min-w-[100px]",children:[e.jsx("span",{className:"text-xs font-medium uppercase",style:{color:t.colors.text.secondary},children:a("sys.workbench.apiTotalCount")}),e.jsx("span",{className:"text-3xl font-bold",style:{color:t.colors.text.primary},children:x(r.totalCount)})]}),e.jsxs("div",{className:"flex flex-col gap-1 min-w-[100px]",children:[e.jsx("span",{className:"text-xs font-medium uppercase",style:{color:t.colors.text.secondary},children:a("sys.workbench.apiAvgLatency")}),e.jsxs("span",{className:"text-3xl font-bold",style:{color:t.colors.text.primary},children:[r.avgLatency," ms"]})]}),e.jsxs("div",{className:"flex flex-col gap-1 min-w-[100px] cursor-pointer hover:opacity-80 transition-opacity",onClick:s=>p("status5xx",s),children:[e.jsx("span",{className:"text-xs font-medium uppercase",style:{color:t.colors.palette.error.dark},children:a("sys.workbench.api5xxTotal")}),e.jsx("span",{className:"text-3xl font-bold",style:{color:t.colors.text.primary},children:x(r.status5xx)})]}),e.jsxs("div",{className:"flex flex-col gap-1 min-w-[100px] cursor-pointer hover:opacity-80 transition-opacity",onClick:s=>p("maxLatency",s),children:[e.jsx("span",{className:"text-xs font-medium uppercase",style:{color:t.colors.palette.warning.dark},children:a("sys.workbench.apiSlowCount")}),e.jsx("span",{className:"text-3xl font-bold",style:{color:t.colors.text.primary},children:x(r.slowCount)})]})]})})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1 justify-start mt-1",children:[e.jsx(L,{background:`rgba(${t.colors.palette.primary.defaultChannel}, 0.18)`,color:t.colors.palette.primary.dark,icon:"mdi:clock-fast",size:28,onClick:v}),r.updatedAt&&e.jsx("span",{className:"text-xs mt-4 whitespace-nowrap",style:{color:t.colors.text.secondary},children:a("sys.workbench.apiUpdatedAt",{time:r.updatedAt})})]})]})})})}),e.jsx(O,{open:d,onClose:()=>m(!1),enabled:!!i,defaultSort:g})]})}export{B as default};
