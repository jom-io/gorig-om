import{s as E,u as v,j as e,S as z,T as D}from"./index-BPpD_G1B.js";import{a5 as j,H as u,T as a,z as M,s as c}from"./vendor-ui-B8JNe9Dz.js";import{r as g}from"./vendor-core-D3G3Pc5t.js";import"./vendor-utils-9ATX-dPw.js";const F=({dataSource:w,keyword:p,onTraceIDClick:f,onLineNumberClick:k,onFileClick:T,onTimeClick:C})=>{const{themeMode:b}=E(),{t:d}=v(),h=(r,n)=>n?r.split(new RegExp(`(${n})`,"gi")).map((l,t)=>l.toLowerCase()===n.toLowerCase()?e.jsx("span",{style:{backgroundColor:"yellow"},children:l},t):l):r,m=({text:r,keyword:n,charLimit:s=150,globalExpanded:l})=>{const t=r.length>s,i=!l&&t?`${r.slice(0,s)}...`:r;return e.jsx("span",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:h(i,n)})},S=({data:r,keyword:n})=>{const s=Object.entries(r),l=150,[t,i]=g.useState(!1),x=g.useCallback(o=>{if(typeof o=="string")return o;if(o==null)return"";try{return JSON.stringify(o,null,2)}catch{return String(o)}},[]),_=g.useMemo(()=>s.some(([,o])=>x(o).length>150),[s,x]);return e.jsxs("div",{style:{fontSize:"12px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[s.map(([o,y])=>{const L=x(y);return e.jsxs("div",{children:[e.jsxs(c.Text,{strong:!0,children:[o,": "]}),e.jsx(m,{text:L,keyword:n,charLimit:l,globalExpanded:t})]},o)}),_&&e.jsx("div",{style:{marginTop:8},children:t?e.jsx(c.Link,{onClick:()=>i(!1),children:d("sys.log.collapse")}):e.jsx(c.Link,{onClick:()=>i(!0),children:d("sys.log.expandAll")})})]})};return e.jsx(j,{style:{marginTop:"-20px"},dataSource:w,renderItem:r=>{const n=r.path&&r.line?`${r.path}-${r.line}`:`default-key-${Math.random()}`;return e.jsx(j.Item,{style:{backgroundColor:r.highlight?b===D.Light?"#FEF4D4":"#613400":"transparent"},children:e.jsx("div",{className:"w-full",style:{padding:"4px 0"},children:e.jsxs(u,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsxs(u,{wrap:!0,size:"small",style:{padding:"4px 0"},children:[e.jsxs(a,{color:"purple",style:{cursor:"pointer"},onClick:s=>k?.(r.path,r.line,s),children:[d("sys.log.lineNumber"),": ",r.line]}),e.jsx(a,{color:r.record.level==="error"||r.record.level==="fatal"||r.record.level==="dpanic"?"error":r.record.level==="warn"?"warning":"success",children:r.record.level.toUpperCase()}),e.jsx(a,{color:"blue",style:{cursor:"pointer"},onClick:s=>C?.(r.record.time,s),children:M(r.record.time).format("YYYY-MM-DD HH:mm:ss")}),r.record._trace_id_&&e.jsxs(a,{color:"orange",onClick:s=>f?.(r.record._trace_id_,s),style:{cursor:"pointer"},children:["TraceID: ",r.record._trace_id_]}),e.jsx(a,{color:"cyan",onClick:s=>T?.(r.path,s),style:{cursor:"pointer"},children:e.jsxs(u,{size:4,children:[d("sys.log.file"),": ",r.path,e.jsx(z,{icon:"ic_download",size:14})]})})]}),e.jsxs(c.Paragraph,{className:"whitespace-pre-wrap",style:{margin:0},children:[h(r.record.msg,p||""),r.record.error&&e.jsx(c.Text,{style:{color:"red",marginLeft:4},children:h(r.record.error,p||"")})]}),r.record.data&&Object.keys(r.record.data).length>0&&e.jsx(S,{data:r.record.data,keyword:p||""})]})})},n)}})};export{F as LogList};
