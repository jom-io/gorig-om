import{s as E,u as L,j as e,S as $,T as f}from"./index-AHjT66P3.js";import{a5 as k,H as g,T as c,z as v,s as d}from"./vendor-ui-B8JNe9Dz.js";import{r as u}from"./vendor-core-D3G3Pc5t.js";import"./vendor-utils-9ATX-dPw.js";const Y=({dataSource:w,keyword:p,onTraceIDClick:T,onLineNumberClick:C,onFileClick:b,onTimeClick:F})=>{const{themeMode:j}=E(),{t:i}=L(),h=(r,l)=>{if(!l)return r;const s=r.split(new RegExp(`(${l})`,"gi")),a=j===f.Dark;return s.map((n,t)=>n.toLowerCase()===l.toLowerCase()?e.jsx("span",{style:{backgroundColor:a?"#B66816":"#FFE3D5",color:a?"#FFFFFF":"#000000",fontWeight:600,padding:"0 2px"},children:n},`highlight-${t}-${n}`):e.jsx("span",{children:n},`text-${t}-${n}`))},m=({text:r,keyword:l,charLimit:s=150,globalExpanded:a})=>{const n=r.length>s,t=!a&&n?`${r.slice(0,s)}...`:r;return e.jsx("span",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:h(t,l)})},S=({data:r,keyword:l})=>{const s=Object.entries(r),a=150,[n,t]=u.useState(!1),x=u.useCallback(o=>{if(typeof o=="string")return o;if(o==null)return"";try{return JSON.stringify(o,null,2)}catch{return String(o)}},[]),_=u.useMemo(()=>s.some(([,o])=>x(o).length>150),[s,x]);return e.jsxs("div",{style:{fontSize:"12px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[s.map(([o,y])=>{const D=x(y);return e.jsxs("div",{children:[e.jsxs(d.Text,{strong:!0,children:[o,": "]}),e.jsx(m,{text:D,keyword:l,charLimit:a,globalExpanded:n})]},o)}),_&&e.jsx("div",{style:{marginTop:8},children:n?e.jsx(d.Link,{onClick:()=>t(!1),children:i("sys.log.collapse")}):e.jsx(d.Link,{onClick:()=>t(!0),children:i("sys.log.expandAll")})})]})};return e.jsx(k,{style:{marginTop:"-20px"},dataSource:w,renderItem:r=>{const l=r.path&&r.line?`${r.path}-${r.line}`:`default-key-${Math.random()}`;return e.jsx(k.Item,{style:{backgroundColor:r.highlight?j===f.Light?"#FEF4D4":"#613400":"transparent"},children:e.jsx("div",{className:"w-full",style:{padding:"4px 0"},children:e.jsxs(g,{direction:"vertical",style:{width:"100%"},size:"small",children:[e.jsxs(g,{wrap:!0,size:"small",style:{padding:"4px 0"},children:[e.jsxs(c,{color:"purple",style:{cursor:"pointer"},onClick:s=>C?.(r.path,r.line,s),children:[i("sys.log.lineNumber"),": ",r.line]}),e.jsx(c,{color:r.record.level==="error"||r.record.level==="fatal"||r.record.level==="dpanic"?"error":r.record.level==="warn"?"warning":"success",children:r.record.level.toUpperCase()}),e.jsx(c,{color:"blue",style:{cursor:"pointer"},onClick:s=>F?.(r.record.time,s),children:v(r.record.time).format("YYYY-MM-DD HH:mm:ss")}),r.record._trace_id_&&e.jsxs(c,{color:"orange",onClick:s=>T?.(r.record._trace_id_,s),style:{cursor:"pointer"},children:["TraceID: ",r.record._trace_id_]}),e.jsx(c,{color:"cyan",onClick:s=>b?.(r.path,s),style:{cursor:"pointer"},children:e.jsxs(g,{size:4,children:[i("sys.log.file"),": ",r.path,e.jsx($,{icon:"ic_download",size:14})]})})]}),e.jsxs(d.Paragraph,{className:"whitespace-pre-wrap",style:{margin:0},children:[h(r.record.msg,p||""),r.record.error&&e.jsx(d.Text,{style:{color:"red",marginLeft:4},children:h(r.record.error,p||"")})]}),r.record.data&&Object.keys(r.record.data).length>0&&e.jsx(S,{data:r.record.data,keyword:p||""})]})})},l)}})};export{Y as LogList};
