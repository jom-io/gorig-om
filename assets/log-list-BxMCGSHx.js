import{w as _,u as m,j as r,T as v}from"./index-DBq9XUmR.js";import{a5 as g,H as y,T as d,z as E,s as a}from"./vendor-ui-BgnAtmuh.js";import{r as j}from"./vendor-core-Cler3e7Q.js";import"./vendor-utils-Dg5_7-NF.js";const Y=({dataSource:u,keyword:p,onTraceIDClick:k,onLineNumberClick:w,onFileClick:f,onTimeClick:T})=>{const{themeMode:C}=_(),{t}=m(),h=(e,n)=>n?e.split(new RegExp(`(${n})`,"gi")).map((l,o)=>l.toLowerCase()===n.toLowerCase()?r.jsx("span",{style:{backgroundColor:"yellow"},children:l},o):l):e,L=({text:e,keyword:n,lineLimit:s=2})=>{const[l,o]=j.useState(!1),i=e.split(/\r?\n/),c=i.length>s,x=!l&&c?i.slice(0,s).join(`
`):e;return r.jsxs("span",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[h(x,n),c&&!l&&r.jsx(a.Link,{onClick:()=>o(!0),style:{marginLeft:4},children:t("sys.log.expand")}),c&&l&&r.jsx(a.Link,{onClick:()=>o(!1),style:{marginLeft:4},children:t("sys.log.collapse")})]})},b=({data:e,keyword:n})=>{const s=Object.entries(e),[l,o]=j.useState(!1),i=l?s:s.slice(0,2);return r.jsxs("div",{style:{fontSize:"12px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[i.map(([c,x])=>r.jsxs("div",{children:[r.jsxs(a.Text,{strong:!0,children:[c,": "]}),r.jsx(L,{text:x,keyword:n,lineLimit:2})]},c)),s.length>2&&!l&&r.jsx(a.Link,{onClick:()=>o(!0),children:t("sys.log.expandAll")}),s.length>2&&l&&r.jsx(a.Link,{onClick:()=>o(!1),children:t("sys.log.collapse")})]})};return r.jsx(g,{style:{marginTop:"-20px"},dataSource:u,renderItem:e=>{const n=e.path&&e.line?`${e.path}-${e.line}`:`default-key-${Math.random()}`;return r.jsx(g.Item,{style:{backgroundColor:e.highlight?C===v.Light?"#FEF4D4":"#613400":"transparent"},children:r.jsx("div",{className:"w-full",style:{padding:"4px 0"},children:r.jsxs(y,{direction:"vertical",style:{width:"100%"},size:"small",children:[r.jsxs(y,{wrap:!0,size:"small",style:{padding:"4px 0"},children:[r.jsxs(d,{color:"purple",style:{cursor:"pointer"},onClick:s=>w?.(e.path,e.line,s),children:[t("sys.log.lineNumber"),": ",e.line]}),r.jsx(d,{color:e.record.level==="error"||e.record.level==="fatal"?"error":e.record.level==="warn"?"warning":"success",children:e.record.level.toUpperCase()}),r.jsx(d,{color:"blue",style:{cursor:"pointer"},onClick:s=>T?.(e.record.time,s),children:E(e.record.time).format("YYYY-MM-DD HH:mm:ss")}),e.record._trace_id_&&r.jsxs(d,{color:"orange",onClick:s=>k?.(e.record._trace_id_,s),style:{cursor:"pointer"},children:["TraceID: ",e.record._trace_id_]}),r.jsxs(d,{color:"cyan",onClick:s=>f?.(e.path,s),children:[t("sys.log.file"),": ",e.path]})]}),r.jsxs(a.Paragraph,{className:"whitespace-pre-wrap",style:{margin:0},children:[h(e.record.msg,p||""),e.record.error&&r.jsx(a.Text,{style:{color:"red",marginLeft:4},children:h(e.record.error,p||"")})]}),e.record.data&&Object.keys(e.record.data).length>0&&r.jsx(b,{data:e.record.data,keyword:p||""})]})})},n)}})};export{Y as LogList};
