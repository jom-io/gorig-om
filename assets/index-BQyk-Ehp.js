import{C as n,av as K,aw as M,j as d,ax as P,ay as B,az as L,aA as R,aB as W,b as U,aC as y,aD as V}from"./index-CSQWneH1.js";import{r as p}from"./vendor-core-Cler3e7Q.js";import{u as q,K as T}from"./kanban-column-BDzGHNlc.js";import{T as f,a as F,K as J}from"./kanban-task-_ymZE1TT.js";import{I as Q,i as X}from"./vendor-ui-BgnAtmuh.js";import"./vendor-utils-Dg5_7-NF.js";import"./task-detail-DQDXQLLL.js";const g=t=>{const o=[];for(let r=0;r<t;r+=1)o.push({username:n.person.fullName(),avatar:n.image.avatarGitHub(),content:n.lorem.lines({min:1,max:3}),time:n.date.past()});return o},D=t=>{const o=[];for(let r=0;r<t;r+=1)o.push(n.image.urlPicsumPhotos());return o},x=t=>{const o=[];for(let r=0;r<t;r+=1)o.push(n.image.avatarGitHub());return o},h=t=>{const o=[],r=new Set;for(;o.length<t;){const k=n.helpers.enumValue(F);r.has(k)||(o.push(k),r.add(k))}return o},Y={tasks:{"task-1":{id:"task-1",title:n.lorem.words(3),reporter:n.image.avatarGitHub(),priority:f.LOW,tags:[],comments:[],attachments:[]},"task-2":{id:"task-2",title:n.lorem.words(3),reporter:n.image.avatarGitHub(),assignee:x(1),date:n.date.future(),priority:f.HIGH,tags:h(3),comments:g(1),attachments:D(4)},"task-3":{id:"task-3",title:n.lorem.words(4),reporter:n.image.avatarGitHub(),assignee:x(2),priority:f.MEDIUM,date:n.date.future(),tags:h(2),comments:g(2),attachments:[]},"task-4":{id:"task-4",title:n.lorem.words(5),reporter:n.image.avatarGitHub(),assignee:x(3),priority:f.MEDIUM,tags:h(3),date:n.date.future(),description:n.lorem.lines(5),attachments:[],comments:g(3)},"task-5":{id:"task-5",title:n.lorem.words(4),reporter:n.image.avatarGitHub(),priority:f.HIGH,assignee:x(4),tags:h(4),date:n.date.future(),description:n.lorem.lines(3),attachments:[],comments:g(4)},"task-6":{id:"task-6",title:n.lorem.words(5),reporter:n.image.avatarGitHub(),priority:f.LOW,assignee:x(5),tags:h(5),date:n.date.future(),description:n.lorem.lines(4),attachments:D(5),comments:g(4)}},columns:{"column-1":{id:"column-1",title:"To do",taskIds:["task-1","task-2","task-3"]},"column-2":{id:"column-2",title:"In progress",taskIds:["task-4","task-5"]},"column-3":{id:"column-3",title:"Done",taskIds:["task-6"]}},columnOrder:["column-1","column-2","column-3"]};function ot(){const[t,o]=p.useState(Y),[r,k]=p.useState(null),[v,O]=p.useState(null),[H,C]=p.useState(!1),I=p.useRef(null),G=K(M(V,{activationConstraint:{distance:8}})),A=s=>{const{active:e}=s;k(e.id),O(e.id.toString().startsWith("task-")?"task":"column")},E=s=>{const{active:e,over:i}=s;if(!i){k(null),O(null);return}if(e.id!==i.id)if(v==="column"){const a=t.columnOrder.indexOf(e.id),c=t.columnOrder.indexOf(i.id);o({...t,columnOrder:y(t.columnOrder,a,c)})}else{const a=Object.values(t.columns).find(u=>u.taskIds.includes(e.id)),c=Object.values(t.columns).find(u=>u.taskIds.includes(i.id)||u.id===i.id);if(!a||!c)return;if(a===c){const u=y(a.taskIds,a.taskIds.indexOf(e.id),a.taskIds.indexOf(i.id));o({...t,columns:{...t.columns,[a.id]:{...a,taskIds:u}}})}else{const u=a.taskIds.filter(z=>z!==e.id),l=[...c.taskIds],m=c.taskIds.indexOf(i.id);l.splice(m>=0?m:l.length,0,e.id),o({...t,columns:{...t.columns,[a.id]:{...a,taskIds:u},[c.id]:{...c,taskIds:l}}})}}k(null),O(null)};q("click",s=>{if(I.current&&!I.current.input?.contains(s.target)){const e=I.current.input?.value;e&&N({id:n.string.uuid(),title:e,taskIds:[]}),C(!1)}});const N=s=>{const e={...t,columns:{...t.columns,[s.id]:s},columnOrder:[...t.columnOrder,s.id]};o(e)},w=(s,e)=>{const i=t.columns[s],a={...t,tasks:{...t.tasks,[e.id]:e},columns:{...t.columns,[s]:{...i,taskIds:[...i.taskIds,e.id]}}};o(a)},j=s=>{const e=t.columns[s],i=Object.keys(t.tasks).filter(l=>!e.taskIds.includes(l)).reduce((l,m)=>(l[m]=t.tasks[m],l),{}),a=Object.keys(t.columns).filter(l=>l!==s).reduce((l,m)=>(l[m]=t.columns[m],l),{}),c=Array.from(t.columnOrder).filter(l=>l!==s);o({tasks:i,columns:a,columnOrder:c})},S=s=>{const e=t.columns[s],i=Object.keys(t.tasks).filter(u=>!e.taskIds.includes(u)).reduce((u,l)=>(u[l]=t.tasks[l],u),{}),a={...t.columns,[s]:{...e,taskIds:[]}},c={...t,tasks:i,columns:a};o(c)},b=s=>{const{id:e,title:i}=s,a={...t.columns,[e]:{...t.columns[e],title:i}},c={...t,columns:a};o(c)};return d.jsx(P,{children:d.jsxs("div",{className:"flex",children:[d.jsx(B,{sensors:G,onDragStart:A,onDragEnd:E,children:d.jsxs("div",{className:"flex h-full items-start gap-6 p-1",children:[d.jsx(L,{items:t.columnOrder,strategy:R,children:t.columnOrder.map((s,e)=>{const i=t.columns[s],a=i.taskIds.map(c=>t.tasks[c]);return d.jsx(T,{id:s,index:e,column:i,tasks:a,createTask:w,clearColumn:S,deleteColumn:j,renameColumn:b},s)})}),d.jsxs(W,{children:[r&&v==="column"?d.jsx(T,{id:r,index:t.columnOrder.indexOf(r),column:t.columns[r],tasks:t.columns[r].taskIds.map(s=>t.tasks[s]),createTask:w,clearColumn:S,deleteColumn:j,renameColumn:b,isDragging:!0}):null,r&&v==="task"?d.jsx(J,{id:r,task:t.tasks[r],isDragging:!0}):null]})]})}),d.jsx("div",{className:"ml-[1.6rem] mt-[0.25rem] min-w-[280px]",children:H?d.jsx(Q,{ref:I,size:"large",placeholder:"Column Name",autoFocus:!0}):d.jsxs(X,{onClick:s=>{s.stopPropagation(),C(!0)},className:"!inline-flex !w-full items-center justify-center !text-xs !font-semibold",block:!0,size:"large",children:[d.jsx(U,{icon:"carbon:add",size:20}),d.jsx("div",{children:"Add Column"})]})})]})})}export{ot as default};
