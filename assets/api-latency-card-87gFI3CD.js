import{u as b,a as C,t as s,j as e,b as N}from"./index-BERtlmQb.js";import{s as k}from"./api-sample-modal-DF60HdJW.js";import{C as S}from"./index-DCpAUovq.js";import{z as f,S as A}from"./vendor-ui-DHYkxuVK.js";import{r as o}from"./vendor-core-D3G3Pc5t.js";import L from"./api-latency-chart-CP2UWLJS.js";import"./vendor-utils-CsjJZ8C9.js";import"./useChart-BUFOfR3x.js";import"./vendor-charts-C0vSEv4L.js";const O={totalCount:0,status5xx:0,slowCount:0,avgLatency:0,updatedAt:""},p=a=>a.toLocaleString();function P(){const{t:a}=b(),c=C(),[d,x]=o.useState(!1),[h,m]=o.useState(!1),[r,y]=o.useState(O),[g,w]=o.useState("count"),u=o.useCallback(async()=>{if(c)try{m(!0);const t=f(),n=t.startOf("day").unix(),v=t.unix(),l=await k.apiSummary(n,v);y({totalCount:l.count,status5xx:l.count5xx,slowCount:l.slowCount,avgLatency:Math.round(l.avgLatency),updatedAt:l.updatedAt?f.unix(l.updatedAt).format("HH:mm"):""})}catch{}finally{m(!1)}},[c]);o.useEffect(()=>{u()},[u]);const j=o.useMemo(()=>`linear-gradient(135deg, rgba(${s.colors.palette.primary.lightChannel}, 0.12), rgba(${s.colors.palette.success.lightChannel}, 0.14)) ${s.colors.background.paper}`,[]),i=(t="count",n)=>{n&&n.stopPropagation(),!d&&(w(t),x(!0))};return e.jsxs("div",{onClick:()=>i("count"),className:"h-full w-full",children:[e.jsx(A,{spinning:h,className:"h-full",children:e.jsx(S,{className:"!p-0 overflow-hidden h-full w-full",style:{background:j,padding:0,boxShadow:s.shadows.card,cursor:"pointer",height:"100%",minHeight:133},children:e.jsx("div",{className:"flex h-full flex-col gap-4 p-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",style:{color:s.colors.text.primary},children:a("sys.workbench.apiResponseToday")}),e.jsx("div",{className:"mt-3 flex flex-wrap items-end gap-4 justify-between",children:e.jsxs("div",{className:"flex flex-wrap gap-x-8 gap-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-1 min-w-[100px]",children:[e.jsx("span",{className:"text-xs font-medium uppercase",style:{color:s.colors.text.secondary},children:a("sys.workbench.apiTotalCount")}),e.jsx("span",{className:"text-2xl font-bold",style:{color:s.colors.text.primary},children:p(r.totalCount)})]}),e.jsxs("div",{className:"flex flex-col gap-1 min-w-[100px]",children:[e.jsx("span",{className:"text-xs font-medium uppercase",style:{color:s.colors.text.secondary},children:a("sys.workbench.apiAvgLatency")}),e.jsxs("span",{className:"text-2xl font-bold",style:{color:s.colors.text.primary},children:[r.avgLatency," ms"]})]}),e.jsxs("div",{className:"flex flex-col gap-1 min-w-[100px] cursor-pointer hover:opacity-80 transition-opacity",onClick:t=>i("status5xx",t),children:[e.jsx("span",{className:"text-xs font-medium uppercase",style:{color:s.colors.palette.error.dark},children:a("sys.workbench.api5xxTotal")}),e.jsx("span",{className:"text-2xl font-bold",style:{color:s.colors.text.primary},children:p(r.status5xx)})]}),e.jsxs("div",{className:"flex flex-col gap-1 min-w-[100px] cursor-pointer hover:opacity-80 transition-opacity",onClick:t=>i("maxLatency",t),children:[e.jsx("span",{className:"text-xs font-medium uppercase",style:{color:s.colors.palette.warning.dark},children:a("sys.workbench.apiSlowCount")}),e.jsx("span",{className:"text-2xl font-bold",style:{color:s.colors.text.primary},children:p(r.slowCount)})]})]})})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1 justify-start mt-1",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full",style:{background:`rgba(${s.colors.palette.primary.defaultChannel}, 0.18)`,color:s.colors.palette.primary.dark},children:e.jsx(N,{icon:"mdi:clock-fast",size:26})}),r.updatedAt&&e.jsx("span",{className:"text-xs mt-4 whitespace-nowrap",style:{color:s.colors.text.secondary},children:a("sys.workbench.apiUpdatedAt",{time:r.updatedAt})})]})]})})})}),e.jsx(L,{open:d,onClose:()=>x(!1),enabled:!!c,defaultSort:g})]})}export{P as default};
